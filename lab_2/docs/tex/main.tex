\documentclass[14pt,a4paper,article]{ncc}
\usepackage[utf8]{inputenc}
\usepackage[T1,T2A]{fontenc}
\usepackage[english,russian]{babel}
\usepackage{indentfirst}
\usepackage{misccorr}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{float}
\usepackage{sectsty}
\usepackage[left=15mm,right=15mm, top=20mm,bottom=20mm,bindingoffset=0mm]{geometry}
\pagestyle{plain}

\begin{document}
\begin{titlepage}
    \begin{center}
        \textsc{
            Санкт-Петербургский политехнический университет имени Петра Великого \\[5mm]
            Институт прикладной математики и механики\\[2mm]
            Высшая школа прикладной математики и физики            
        }   
        \vfill
        \textbf{\large
            Математическая статистика\\
            Отчёт по лабораторным работам №5-8 \\[3mm]
        }                
    \end{center}

    \vfill
    \hfill
    \begin{tabular}{l p{140pt} l}
            Выполнил студент \\ группы 5030102/90201 && Фисюк Алексей Юрьевич
            \vspace{0.2cm}
            \\Проверил \\ доцент, к.ф.-м.н. && Баженов Александр Николаевич
    \end{tabular}
    \vfill
    \begin{center}
        \theyear\ г.
    \end{center}
\end{titlepage}

\tableofcontents
\newpage
\listoffigures
\newpage
\listoftables
\newpage

\newpage
\section{Постановка задачи}
\begin{enumerate}
    \item Сгенерировать двумерные выборки размерами 20, 60, 100 для нормального двумерного распределения $N(x,y,0,0,1,1,\rho)$. Коэффициент корреляции $\rho$ взять равным 0, 0.5, 0.9. Каждая выборка генерируется 1000 раз и для неё вычисляются: среднее значение, среднее значение квадрата и дисперсия коэффициентов корреляции Пирсона, Спирмена и квадрантного коэффициента корреляции. Повторить все вычисления для смеси нормальных распределений:
\begin{equation}
	f(x,y) = 0.9N(x,y,0,0,1,1,0.9) + 0.1N(x,y,0,0,10,10,-0.9)
\end{equation}
Изобразить сгенерированные точки на плоскости и нарисовать эллипс равновероятности.
    \item Найти оценки коэффициентов линейной регрессии $y_{i} = a + bx_{i} + e_{i}$, используя 20 точек на отрезке [-1.8; 2] с равномерным шагом равным 0.2. Ошибку $e_{i}$ считать нормально распределённой с параметрами (0, 1). В качестве эталонной зависимости взять $y_{i} = 2 + 2x_{i} + e_{i}$. При построении оценок коэффициентов использовать два критерия: критерий наименьших квадратов и критерий наименьших модулей. Проделать то же самое для выборки, у которой в значения $y_{1}$ и $y_{20}$ вносятся возмущения 10 и -10. 
    \item Сгенерировать выборку объёмом 100 элементов для нормального распределения N(x,0,1). По сгенерированной выборке оценить параметры $\mu$ и $\sigma$ нормального закона методом максимального правдоподобия. В качестве основной гипотезы $H_{0}$ будем считать, что сгенерированное распределение имеет вид $N(x,\hat{\mu}, \hat{\sigma})$. Проверить основную гипотезу, использу критерий согласия $\chi^{2}$. В качестве уровня значимости взять $\alpha$ = 0.05. Привести таблицу вычислений $\chi^{2}$.\\ 
     Исследовать точность (чувствительность) критерия $\chi^{2} - $ сгенерировать выборки равномерного распределения и распределения Лапласа малого объема (например, 20 элементов). Проверить их на нормальность.
     \item Для двух выборок размерами 20 и 100 элементов, сгенерированных согласно нормальному закону $N(x,0,1)$, для параметров положения и масштаба построить асимптотически нормальные интервальные оценки на основе точечных оценок метода максимального правдоподобия и классические интервальные оценки на основе статистик $\chi^{2}$ и Стьюдента. В качестве параметра надёжности взять $\gamma$ = 0.95.
\end{enumerate}

\newpage
\section{Теория}
\input{theory}

\section{Реализация}
Лабораторная работа выполнена на языке Python в среде разработки PyCharm с интерпретатором версии 3.9. Дополнительные зависимости:
\begin{itemize}
    \item scipy
    \item numpy
    \item matplotlib
\end{itemize}
Исходный код: https://github.com/ayu-f/MathStat

\section{Результаты}
\input{result}
\section{Обсуждение}
\begin{flushleft}
\subsection{Выборочные коэффициенты корреляции и эллипсы рассеивания}
\noindent Для двумерного нормального распределения дисперсии выборочных коэффициентов корреляции упорядочены следующим образом: $r <  r_S < r_Q$. 
Для смеси нормальных распределений дисперсии выборочных
коэффициентов корреляции коэффициенты упорядочены обратным образом: $r_Q <  r_S < r$
\newline
Процент попавших элементов выборки в эллипс рассеивания примерно равен его теоретическому значению: 95$\%$
\end{flushleft}
\subsection{Оценки коэффициентов линейной регрессии}
\begin{flushleft}
Критерий наименьших квадратов точнее оценивает коэффициенты
линейной регрессии на выборке без возмущений.
Однако критерий наименьших модулей точнее оценивает коэффициенты линейной регрессии на выборке с возмущениями, так как более устойчив.
\end{flushleft}
\subsection{Проверка гипотезы о законе распределения генеральной совокупности. Метод хи-квадрат}
\begin{flushleft}
По результатам проверки на близость с помощью критерия хи-квадрат можно сделать вывод, что гипотеза $H_{0}$ о нормальном распределении  $N(x,\hat{\mu}, \hat{\sigma})$ на уровне значимости $\alpha = 0.05$ для выборки, сгенерированной согласно $N(x,0,1)$
Видим также, что критерий принял гипотезу $H_{0}$ для выборок, сгенерированных по равномерному закону и закону распределения Лапласа.
\newline
По исследованию на чувствительность заключаем, что при небольших объемах выборки сложно сделать вывод, опираясь на полученные результаты. Это обуславливается небольшим объемом выборки, в то время как статистика критерия $\chi^2$ лишь асимптотически распределена по закону $\chi^2(k-1)$.
\end{flushleft}
\subsection{Доверительные интервалы для параметров распределения}
\begin{flushleft}
Генеральные характеристики ($m = 1$ и $\sigma = 0$) накрываются построенными доверительными интервалами. \\
Доверительные интервалы, полученные по большей выборке, являются соответственно более точными, т.е. меньшими по длине.\\
Доверительные интервалы для параметров нормального распределения более надёжны, так как основаны на точном, а не асимптотическом распределении
\end{flushleft}

\end{document}
